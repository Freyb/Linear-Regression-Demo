import tensorflow as tf

xs = [-0.994389486133253, -0.913931382450392, -0.8421358466214894, -0.7936912079175287, -0.7212703829694503,
      -0.6493092963498907, -0.5831159098947761, -0.49452032943676977, -0.43663593054033933, -0.38103344807953804,
      -0.29056300912140987, -0.2408927469371763, -0.16079655537695162, -0.09023174031441022, -0.052842235223029416,
      0.027278106380782596, 0.12005321295738194, 0.1606942669787829, 0.23191889011606065, 0.290569049030006,
      0.3569833670237974, 0.4462683420214628, 0.5026433636977004, 0.5898973817217393, 0.6281881489589753,
      0.6950465454098467, 0.7589344159093838, 0.8569789947600349, 0.9029653007952807, 0.9678477836721744]
ys = [98.50701253060379, 98.58403304336788, 98.69229698277226, 98.80579267651115, 98.91161583470664, 98.97794652227853,
      99.11710493383737, 99.25062921810947, 99.31403533686297, 99.38708301365111, 99.56362576487015, 99.6282265935078,
      99.76573856077525, 99.86272963052161, 99.9209820372125, 100.05273894598358, 100.18983954932047,
      100.27395847912969, 100.3332425650613, 100.45212779864852, 100.51958639742298, 100.69047642616786,
      100.7677605988325, 100.90775707716762, 100.98810062278984, 101.06286616850794, 101.15059401566896,
      101.3187159020045, 101.38313996365538, 101.48995614521245]

learning_rate = .1

a = tf.Variable(0, dtype=tf.float64, name="a")
b = tf.Variable(0, dtype=tf.float64, name="b")
x = tf.placeholder(dtype=tf.float64, name="x")
y = tf.placeholder(dtype=tf.float64, name="y")

y_pred = a * x + b

cost = tf.reduce_mean(tf.square(y_pred - y))

optimizer = tf.train.GradientDescentOptimizer(learning_rate)
train_op = optimizer.minimize(cost)

init_op = tf.global_variables_initializer()

with tf.Session() as session:
    session.run(init_op)
    print(session.run([a, b, cost], {x: xs, y: ys}))
    for i in range(100):
        (_, cost_val, a_val, b_val) = session.run([train_op, cost, a, b], {x: xs, y: ys})
        print(a_val, b_val, cost_val)
